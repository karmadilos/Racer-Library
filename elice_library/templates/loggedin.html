{% extends 'base.html' %}
{% block content %}
<main>
    <section class="py-5 text-center container">
      <div class="row py-lg-5">
        <div class="col-lg-6 col-md-8 mx-auto">
          <h3 class="fw-light">레이서 도서관</h3>
          <p class="lead text-muted">원하는 책을 찾아보고 대여하세요!</p>
          <p>
            <a href="#" class="btn btn-primary my-2">웹 개발</a>
            <a href="#" class="btn btn-secondary my-2">인공지능</a>
          </p>
        </div>
      </div>
    </section>
    <div class="album py-5 bg-light">
      <div class="container">
        <div class="row row-cols-1 row-cols-sm-2 row-cols-md-3 g-3">
          <!-- Pagination 객체로 변경되었으므로 book_list를 book_list.items로 변경 -->
          {% for book in book_list.items %}
          <div class="col">
            <div class="card shadow-sm">
              <img src="{{ book.image_path }}">
              <div class="card-body">
                <p class="card-text"><a href="/book/{{ book.id }}">{{ book.bookname }}</a></p>
                <div class="d-flex justify-content-between align-items-center">
                  <div class="btn-group">
                    <form action = "/" method="POST">
                      <input type="hidden" name = "book_id" value = "{{ book.id }}">
                      <button class="btn btn-sm btn-outline-secondary">대여하기</button>
                      <!-- <button>요소 자체는 submit속성을 지니고 있기 때문에 type 정의가 되어있지 않다면 submit 동작을 한다. -->
                    </form>
                    <button type="button" class="btn btn-sm btn-outline-secondary">리뷰쓰기</button>
                  </div>
                  <small class="text-muted">남은책수 : {{ book.stock }}</small>
                </div>
              </div>
            </div>
          </div>
          {% endfor %}
        </div>
      </div>
      <br/>
      <!-- 페이징처리 시작 -->
    <ul class="pagination justify-content-center">
      <li class="page-item">
        <a class="page-link" href="?page=1">처음</a>
      </li>
      <!-- 이전페이지 -->
      {% if book_list.has_prev %}
      <li class="page-item">
          <a class="page-link" href="?page={{ book_list.prev_num }}">이전</a>
      </li>
      {% else %}
      <li class="page-item disabled">
          <a class="page-link" tabindex="-1" aria-disabled="true" href="#">이전</a>
      </li>
      {% endif %}
      {% for page_num in book_list.iter_pages() %}
          {% if page_num %}
              {% if page_num != book_list.page %}
              <li class="page-item">
                  <a class="page-link" href="?page={{ page_num }}">{{ page_num }}</a>
              </li>
              {% else %}
              <li class="page-item active" aria-current="page">
                  <a class="page-link" href="#">{{ page_num }}</a>
              </li>
              {% endif %}
         {% else %}
              <li class="disabled">
                  <a class="page-link" href="#">...</a>
              </li>
         {% endif %}
      {% endfor %}
      <!-- 다음페이지 -->
      {% if book_list.has_next %}
      <li class="page-item">
          <a class="page-link" href="?page={{ book_list.next_num }}">다음</a>
      </li>
      {% else %}
      <li class="page-item disabled">
          <a class="page-link" tabindex="-1" aria-disabled="true" href="#">다음</a>
      </li>
      {% endif %}
      <li class="page-item">
        <a class="page-link" href="?page={{ (book_list.total//book_list.per_page)+1 }}">끝</a>
      </li>
    </ul>
  <!-- 페이징처리 끝 -->
    </div>
</main>
{% endblock %}